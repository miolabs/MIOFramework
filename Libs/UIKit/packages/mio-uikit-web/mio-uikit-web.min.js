"use strict";var MUIAnimationType,__extends=this&&this.__extends||function(){var i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};return function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}();function MUICoreLayerIDFromObject(e){return MUICoreLayerIDFromClassname(e.constructor.name.substring(3))}function MUICoreLayerIDFromClassname(e){for(var t=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],n="",i=0;i<4;i++){n+=t[Math.floor(16*Math.random())]}return e.toLowerCase()+"_"+n}function MUICoreLayerCreate(e){var t=document.createElement("DIV");return null!=e&&t.setAttribute("id",e),t}function MUICoreLayerAddSublayer(e,t){e.appendChild(t)}function MUICoreLayerRemoveSublayer(e,t){e.removeChild(t)}function MUICoreLayerCreateWithStyle(e,t){var n=MUICoreLayerCreate(t);return MUICoreLayerAddStyle(n,e),n}function MUICoreLayerAddStyle(e,t){e.classList.add(t)}function MUICoreLayerRemoveStyle(e,t){e.classList.remove(t)}function MUICoreLayerSearchElementByAttribute(e,t){if("DIV"!=e.tagName&&"INPUT"!=e.tagName&&"SECTION"!=e.tagName)return null;if("true"==e.getAttribute(t))return e;for(var n=null,i=0;i<e.childNodes.length;i++){if(null!=(n=MUICoreLayerSearchElementByAttribute(e.childNodes[i],t)))return n}return null}function MUICoreLayerSearchElementByID(e,t){if("DIV"!=e.tagName&&"INPUT"!=e.tagName&&"SECTION"!=e.tagName)return null;if(e.getAttribute("data-outlet")==t)return e;if(e.getAttribute("id")==t)return e;for(var n=null,i=0;i<e.childNodes.length;i++){if(null!=(n=MUICoreLayerSearchElementByID(e.childNodes[i],t)))return n}return null}function MUICoreLayerGetFirstElementWithTag(e,t){var n=null;if(0<e.childNodes.length){var i=0;for(n=e.childNodes[i];n.tagName!=t;){if(++i>=e.childNodes.length){n=null;break}n=e.childNodes[i]}}return n}function MUIClassListForAnimationType(e){var t=[];switch(t.push("animated"),e){case MUIAnimationType.BeginSheet:t.push("slideInDown");break;case MUIAnimationType.EndSheet:t.push("slideOutUp");break;case MUIAnimationType.Push:t.push("slideInRight");break;case MUIAnimationType.Pop:t.push("slideOutRight");break;case MUIAnimationType.FadeIn:t.push("fadeIn");break;case MUIAnimationType.FadeOut:t.push("fadeOut");break;case MUIAnimationType.LightSpeedOut:t.push("lightSpeedOut");break;case MUIAnimationType.Hinge:t.push("hinge");break;case MUIAnimationType.SlideInUp:t.push("slideInUp");break;case MUIAnimationType.SlideOutDown:t.push("slideOutDown");break;case MUIAnimationType.SlideInRight:t.push("slideInRight");break;case MUIAnimationType.SlideOutRight:t.push("slideOutRight");break;case MUIAnimationType.SlideInLeft:t.push("slideInLeft");break;case MUIAnimationType.SlideOutLeft:t.push("slideOutLeft");break;case MUIAnimationType.HorizontalOutFlip:t.push("flipOutY");break;case MUIAnimationType.HorizontalInFlip:t.push("flipInY");break;case MUIAnimationType.ZoomIn:t.push("zoomIn");break;case MUIAnimationType.ZoomOut:t.push("zoomOut")}return t}function _MUIAddAnimations(e,t){e.offsetWidth;for(var n=0;n<t.length;n++)e.classList.add(t[n])}function _MUIRemoveAnimations(e,t){for(var n=0;n<t.length;n++)e.classList.remove(t[n])}function _MUIAnimationStart(e,t,n,i,o){if(null!=t){var r=t.transitionDuration(n),l=t.animations(n);if(t.animateTransition(n),0==r||null==l)return t.animationEnded(!0),void(null!=i&&null!=o&&o.call(i));e.style.animationDuration=r+"s",_MUIAddAnimations(e,l),e.animationParams={},e.animationParams.animationController=t,e.animationParams.animations=l,null!=i&&(e.animationParams.target=i),null!=o&&(e.animationParams.completion=o),e.addEventListener("animationend",_UIAnimationDidFinish)}else null!=i&&null!=o&&o.call(i)}function _UIAnimationDidFinish(e){var t=e.target.animationParams.animationController,n=e.target.animationParams.animations,i=e.target.animationParams.target,o=e.target.animationParams.completion,r=e.target;_MUIRemoveAnimations(r,n),r.removeEventListener("animationend",_UIAnimationDidFinish),t.animationEnded(!0),null!=i&&null!=o&&o.call(i)}!function(e){e[e.None=0]="None",e[e.BeginSheet=1]="BeginSheet",e[e.EndSheet=2]="EndSheet",e[e.Push=3]="Push",e[e.Pop=4]="Pop",e[e.FlipLeft=5]="FlipLeft",e[e.FlipRight=6]="FlipRight",e[e.FadeIn=7]="FadeIn",e[e.FadeOut=8]="FadeOut",e[e.LightSpeedIn=9]="LightSpeedIn",e[e.LightSpeedOut=10]="LightSpeedOut",e[e.Hinge=11]="Hinge",e[e.SlideInUp=12]="SlideInUp",e[e.SlideOutDown=13]="SlideOutDown",e[e.SlideInRight=14]="SlideInRight",e[e.SlideOutRight=15]="SlideOutRight",e[e.SlideInLeft=16]="SlideInLeft",e[e.SlideOutLeft=17]="SlideOutLeft",e[e.HorizontalOutFlip=18]="HorizontalOutFlip",e[e.HorizontalInFlip=19]="HorizontalInFlip",e[e.ZoomIn=20]="ZoomIn",e[e.ZoomOut=21]="ZoomOut"}(MUIAnimationType||(MUIAnimationType={})),window.onload=function(e){var t=MIOCoreBundleGetMainURLString();console.log("Main URL: "+t),main(t)},window.onerror=function(e){console.log("window.onerror ::"+JSON.stringify(e))};var _miocore_events_event_observers={};function MUICoreEventRegisterObserverForType(e,t,n){var i={Target:t,Completion:n},o=_miocore_events_event_observers[e];null==o&&(o=[],_miocore_events_event_observers[e]=o),o.push(i)}function MUICoreEventUnregisterObserverForType(e,t){var n=_miocore_events_event_observers[e];if(null!=n){for(var i=-1,o=0;o<n.length;o++){if(n[o].Target===t){i=o;break}}-1<i&&(console.log("removing event observer: "+n.length),n.splice(i,1),console.log("removing event observer: "+n.length),console.log("removing event observer: "+_miocore_events_event_observers[e].length))}}function _MUICoreEventSendToObservers(e,t){if(null!=e)for(var n=0;n<e.length;n++){var i=e[n],o=i.Target;i.Completion.call(o,t)}}function MUICoreBundleLoadNibName(n,e,t){var i=new MUICoreNibParser;i.target=e,i.completion=t,MIOCoreBundleGetContentsFromURLString(n,this,function(e,t){if(200!=e)throw new Error("MUICoreBundleLoadNibName: Couldn't download resource "+n);i.parseString(t)})}window.addEventListener("keydown",function(e){var t=new MUICoreKeyEvent;t.initWithKeyCode(MUICoreEventType.KeyDown,e.keyCode,e),_MUICoreEventSendToObservers(_miocore_events_event_observers[MUICoreEventType.KeyDown],t)},!1),window.addEventListener("keyup",function(e){var t=new MUICoreKeyEvent;t.initWithKeyCode(MUICoreEventType.KeyUp,e.keyCode,e),_MUICoreEventSendToObservers(_miocore_events_event_observers[MUICoreEventType.KeyUp],t)},!1),window.addEventListener("mousedown",function(e){var t=new MUICoreKeyEvent;t.initWithType(MUICoreEventType.MouseDown,e),_MUICoreEventSendToObservers(_miocore_events_event_observers[MUICoreEventType.MouseDown],t)},!1),window.addEventListener("mouseup",function(e){var t=new MUICoreEventMouse;t.initWithType(MUICoreEventType.MouseUp,e),_MUICoreEventSendToObservers(_miocore_events_event_observers[MUICoreEventType.MouseUp],t),_MUICoreEventSendToObservers(_miocore_events_event_observers[MUICoreEventType.Click],t)},!1),window.addEventListener("touchend",function(e){var t=new MUICoreEventTouch;t.initWithType(MUICoreEventType.TouchEnd,e),_MUICoreEventSendToObservers(_miocore_events_event_observers[MUICoreEventType.TouchEnd],t),_MUICoreEventSendToObservers(_miocore_events_event_observers[MUICoreEventType.Click],t)},!1),window.addEventListener("resize",function(e){var t=new MUICoreEvent;t.initWithType(MUICoreEventType.Resize,e),_MUICoreEventSendToObservers(_miocore_events_event_observers[MUICoreEventType.Resize],t)},!1);var MUICoreEventKeyCode,MUICoreEventType,MUICoreNibParser=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.target=null,e.completion=null,e.result="",e.isCapturing=!1,e.elementCapturingCount=0,e.layerID=null,e.rootClassname=null,e.currentString=null,e.currentStringLocalizedKey=null,e}return __extends(e,t),e.prototype.parseString=function(e){var t=new MIOCoreHTMLParser;t.initWithString(e,this),t.parse();var n=(new DOMParser).parseFromString(this.result,"text/html").getElementById(this.layerID),i=NSClassFromString(this.rootClassname);if(i.initWithLayer(n,i),0<n.childNodes.length)for(var o=0;o<n.childNodes.length;o++){var r=n.childNodes[o];if(("DIV"==r.tagName||"SECTION"==r.tagName)&&"true"==r.getAttribute("data-outlets"))for(var l=0;l<r.childNodes.length;l++){var s=r.childNodes[l];if("DIV"==s.tagName){var a=s.getAttribute("data-property"),u=s.getAttribute("data-outlet");this.connectOutlet(i,a,u)}}}this.completion.call(this.target,i)},e.prototype.connectOutlet=function(e,t,n){console.log("prop: "+t+" - outluet: "+n);var i=e._outlets[n];e[t]=_injectIntoOptional(i)},e.prototype.parserDidStartDocument=function(e){console.log("parser started")},e.prototype.parserDidStartElement=function(e,t,n){"div"==t.toLocaleLowerCase()&&"true"==n["data-root-view-controller"]&&(this.isCapturing=!0,this.layerID=n.id,this.rootClassname=n["data-class"]),1==this.isCapturing&&(this.openTag(t,n),this.elementCapturingCount++)},e.prototype.parserFoundCharacters=function(e,t){1==this.isCapturing&&(null==this.currentString?this.currentString=t:this.currentString+=" "+t)},e.prototype.parserFoundComment=function(e,t){1==this.isCapturing&&(this.result+="\x3c!-- "+t+"--\x3e")},e.prototype.parserDidEndElement=function(e,t){1==this.isCapturing&&(this.closeTag(t),this.elementCapturingCount--),0==this.elementCapturingCount&&(this.isCapturing=!1),this.currentString=null},e.prototype.parserDidEndDocument=function(e){console.log("html parser finished"),console.log(this.result)},e.prototype.openTag=function(e,t){for(var n in this.translateCharacters(),this.result+="<"+e,t){var i=t[n];this.result+=null!=i?" "+n+"='"+i+"'":" "+n}this.result+=">","span"==e&&(this.currentStringLocalizedKey=t["localized-key"]||t["data-localized-key"])},e.prototype.closeTag=function(e){this.translateCharacters(),this.result+="</"+e+">"},e.prototype.translateCharacters=function(){null!=this.currentString&&(null==this.currentStringLocalizedKey?this.result+=this.currentString:this.result+=NSLocalizeString(this.currentStringLocalizedKey,this.currentString)),this.currentString=null,this.currentStringLocalizedKey=null},e}(NSObject);!function(e){e[e.Enter=13]="Enter",e[e.Escape=27]="Escape",e[e.ArrowLeft=37]="ArrowLeft",e[e.ArrowUp=38]="ArrowUp",e[e.ArrowRight=39]="ArrowRight",e[e.ArrowDown=40]="ArrowDown"}(MUICoreEventKeyCode||(MUICoreEventKeyCode={})),function(e){e[e.KeyUp=0]="KeyUp",e[e.KeyDown=1]="KeyDown",e[e.MouseUp=2]="MouseUp",e[e.MouseDown=3]="MouseDown",e[e.TouchStart=4]="TouchStart",e[e.TouchEnd=5]="TouchEnd",e[e.Click=6]="Click",e[e.Resize=7]="Resize"}(MUICoreEventType||(MUICoreEventType={}));var MUICoreEventMouseButtonType,MUICoreEvent=function(){function e(){this.eventType=null,this.target=null,this.completion=null}return e.prototype.initWithType=function(e,t){this.coreEvent=t,this.eventType=e},e.prototype.cancel=function(){this.coreEvent.preventDefault()},e}(),MUICoreKeyEvent=function(i){function e(){var e=null!==i&&i.apply(this,arguments)||this;return e.keyCode=null,e}return __extends(e,i),e.prototype.initWithKeyCode=function(e,t,n){i.prototype.initWithType.call(this,e,n),this.keyCode=t},e}(MUICoreEvent),MUICoreEventInput=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.target=null,e.x=0,e.y=0,e.deltaX=0,e.deltaY=0,e}return __extends(e,t),e}(MUICoreEvent);!function(e){e[e.None=0]="None",e[e.Left=1]="Left",e[e.Right=2]="Right",e[e.Middle=3]="Middle"}(MUICoreEventMouseButtonType||(MUICoreEventMouseButtonType={}));var UIGestureRecognizerState,MUICoreEventMouse=function(n){function e(){var e=null!==n&&n.apply(this,arguments)||this;return e.button=MUICoreEventMouseButtonType.None,e}return __extends(e,n),e.prototype.initWithType=function(e,t){n.prototype.initWithType.call(this,e,event),this.button=MUICoreEventMouseButtonType.Left,this.target=t.target,this.x=t.clientX,this.y=t.clientY},e}(MUICoreEventInput),MUICoreEventTouch=function(i){function e(){return null!==i&&i.apply(this,arguments)||this}return __extends(e,i),e.prototype.initWithType=function(e,t){i.prototype.initWithType.call(this,e,event);var n=t.changedTouches[0];this.target=t.target,this.x=n.clientX,this.y=n.clientY},e}(MUICoreEventInput),UIEvent=function(t){function n(){var e=null!==t&&t.apply(this,arguments)||this;return e.x=0,e.y=0,e}return __extends(n,t),n.eventWithSysEvent=function(e){var t=new n;return t.initWithSysEvent(e),t},n.prototype.initWithSysEvent=function(e){t.prototype.init.call(this),this.x=e.clientX,this.y=e.clientY},n}(NSObject);!function(e){e[e.Possible=0]="Possible",e[e.Began=1]="Began",e[e.Changed=2]="Changed",e[e.Ended=3]="Ended",e[e.Cancelled=4]="Cancelled",e[e.Failed=5]="Failed",e[e.Recognized=6]="Recognized"}(UIGestureRecognizerState||(UIGestureRecognizerState={}));var UIGestureRecognizer=function(n){function e(){var e=null!==n&&n.apply(this,arguments)||this;return e.delegate=null,e.isEnabled=!0,e.name=null,e.target=null,e.block=null,e._view=null,e._state=UIGestureRecognizerState.Possible,e}return __extends(e,n),Object.defineProperty(e.prototype,"view",{get:function(){return this._view},set:function(e){this.setView(e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"state",{get:function(){return this._state},set:function(e){this.setState(e)},enumerable:!0,configurable:!0}),e.prototype.initWithTarget=function(e,t){n.prototype.init.call(this),this.target=e,this.block=t},e.prototype.setView=function(e){this._view=e},e.prototype.setState=function(e){0!=this.isEnabled&&(this._state==e&&e!=UIGestureRecognizerState.Changed||(this._state=e,this.block.call(this.target,this)))},e.prototype.touchesBeganWithEvent=function(e,t){this.state=UIGestureRecognizerState.Began},e.prototype.touchesMovedWithEvent=function(e,t){this.state=UIGestureRecognizerState.Changed},e.prototype.touchesEndedWithEvent=function(e,t){this.state=UIGestureRecognizerState.Ended},e.prototype.reset=function(){this.state=UIGestureRecognizerState.Possible},e.prototype._viewTouchesBeganWithEvent=function(e,t){this.reset(),this.touchesBeganWithEvent(e,t)},e.prototype._viewTouchesMovedWithEvent=function(e,t){this.touchesMovedWithEvent(e,t)},e.prototype._viewTouchesEndedWithEvent=function(e,t){this.touchesEndedWithEvent(e,t)},e}(NSObject),UITapGestureRecognizer=function(n){function e(){var e=null!==n&&n.apply(this,arguments)||this;return e.numberOfTapsRequired=1,e}return __extends(e,n),e.prototype.touchesBeganWithEvent=function(e,t){n.prototype.touchesBeganWithEvent.call(this,e,t),this.state=UIGestureRecognizerState.Began},e.prototype.touchesEndedWithEvent=function(e,t){n.prototype.touchesEndedWithEvent.call(this,e,t),this.state=UIGestureRecognizerState.Ended},e}(UIGestureRecognizer),UIPanGestureRecognizer=function(n){function e(){var e=null!==n&&n.apply(this,arguments)||this;return e.minimumNumberOfTouches=1,e.maximumNumberOfTouches=0,e.initialX=null,e.initialY=null,e.touchDown=!1,e.hasStarted=!1,e.deltaX=0,e.deltaY=0,e}return __extends(e,n),e.prototype.touchesBeganWithEvent=function(e,t){this.initialX=t.x,this.initialY=t.y,this.touchDown=!0},e.prototype.touchesEndedWithEvent=function(e,t){n.prototype.touchesEndedWithEvent.call(this,e,t),this.initialX=null,this.initialY=null,this.hasStarted=!1,this.touchDown=!1},e.prototype.touchesMovedWithEvent=function(e,t){0!=this.touchDown&&(0==this.hasStarted&&(this.state=UIGestureRecognizerState.Began),this.hasStarted=!0,this.deltaX=this.initialX-t.x,this.deltaY=this.initialY-t.y,this.state=UIGestureRecognizerState.Changed)},e.prototype.translationInView=function(e){return new NSPoint(this.deltaX,this.deltaY)},e}(UIGestureRecognizer);function MUICoreViewSearchViewTag(e,t){if(e.tag==t)return e;for(var n=0;n<e.subviews.length;n++){var i=e.subviews[n];if(null!=(i=MUICoreViewSearchViewTag(i,t)))return i}return null}var UIButtonType,UIView=function(n){function u(e){var t=n.call(this)||this;return t.layerID=null,t.layer=null,t.layerOptions=null,t.alpha=1,t.tag=0,t._parent=null,t._viewIsVisible=!1,t._needDisplay=!0,t._isLayerInDOM=!1,t._subviews=[],t._window=null,t._outlets={},t._hidden=!1,t.x=0,t.y=0,t.width=0,t.height=0,t._userInteraction=!1,t.isMouseDown=!1,t.gestureRecognizers=[],t.layerID=e||MUICoreLayerIDFromObject(t),t}return __extends(u,n),Object.defineProperty(u.prototype,"parent",{get:function(){return this._parent},set:function(e){this.setParent(e)},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"subviews",{get:function(){return this._subviews},enumerable:!0,configurable:!0}),u.prototype.init=function(){this.layer=MUICoreLayerCreate(this.layerID)},u.prototype.initWithFrame=function(e){this.layer=MUICoreLayerCreate(this.layerID),this.layer.style.position="absolute",this.setX(e.origin.x),this.setY(e.origin.y),this.setWidth(e.size.width),this.setHeight(e.size.height)},u.prototype.initWithLayer=function(e,t,n){this.layer=e,this.layerOptions=n;var i=this.layer.getAttribute("id");null!=i&&(this.layerID=i);var o=this.layer.getAttribute("data-tag");if(this.tag=o||0,this._addLayerToDOM(),0<this.layer.childNodes.length)for(var r=0;r<this.layer.childNodes.length;r++){var l=this.layer.childNodes[r];if("DIV"==l.tagName||"SECTION"==l.tagName){var s=l.getAttribute("data-class");null!=s&&0!=s.length||(s="UIView");var a=NSClassFromString(s);a.initWithLayer(l,t),this._linkViewToSubview(a);var u=l.getAttribute("id");null!=u&&(t._outlets[u]=a)}}},u.prototype.copy=function(){var e=this.layer.cloneNode(!0),t=this.getClassName();if(null==t)throw Error("UIView:copy: Error classname is null");var n=NSClassFromString(t);return n.initWithLayer(e,null),n},u.prototype.awakeFromHTML=function(){},u.prototype.setParent=function(e){this.willChangeValue("parent"),this._parent=e,this.didChangeValue("parent")},u.prototype.addSubLayer=function(e){this.layer.innerHTML=e.innerHTML},u.prototype._linkViewToSubview=function(e){if(e instanceof u==0)throw new Error("_linkViewToSubview: Trying to add an object that is not a view");this.subviews.push(e)},u.prototype.addSubview=function(e,t){if(e instanceof u==0)throw new Error("addSubview: Trying to add an object that is not a view");e.setParent(this),null==t?this.subviews.push(e):this.subviews.splice(t,0,e),e._addLayerToDOM(t),e.setNeedsDisplay()},u.prototype.insertSubviewAboveSubview=function(e,t){e.setParent(this);var n=this.subviews.indexOf(t);this.subviews.splice(n,0,e),this.addLayerBeforeLayer(e.layer,t.layer),e.setNeedsDisplay()},u.prototype.addLayerBeforeLayer=function(e,t){1!=e._isLayerInDOM&&null!=t&&null!=e&&(this.layer.insertBefore(e,t),e._isLayerInDOM=!0)},u.prototype._addLayerToDOM=function(e){1!=this._isLayerInDOM&&null!=this.layer&&null!=this.parent&&(null==e?this.parent.layer.appendChild(this.layer):this.parent.layer.insertBefore(this.layer,this.parent.layer.children[0]),this._isLayerInDOM=!0)},u.prototype.removeFromSuperview=function(){if(null!=this.parent){var e=this.parent._subviews,t=e.indexOf(this);e.splice(t,1),0!=this._isLayerInDOM&&(this.parent.layer.removeChild(this.layer),this._isLayerInDOM=!1)}},u.prototype._removeLayerFromDOM=function(){0!=this._isLayerInDOM&&(this.layer.removeChild(this.layer),this._isLayerInDOM=!1)},u.prototype._removeAllSubviews=function(){for(var e=this.layer;this.layer.hasChildNodes();)e.hasChildNodes()?e=e.lastChild:(e=e.parentNode).removeChild(e.lastChild)},u.prototype.setViewIsVisible=function(e){this._viewIsVisible=!0;for(var t=0;t<this.subviews.length;t++){this.subviews[t].setViewIsVisible(e)}},u.prototype.viewWithTag=function(e){return MUICoreViewSearchViewTag(this,e)},u.prototype.layoutSubviews=function(){for(var e=0;e<this.subviews.length;e++){var t=this.subviews[e];if(t instanceof u==0)throw new Error("layout: Trying to layout an object that is not a view");t.setNeedsDisplay()}},u.prototype.setNeedsDisplay=function(){if(this._needDisplay=!0,0!=this._viewIsVisible&&1!=this.hidden){this._needDisplay=!1,this.layoutSubviews();for(var e=0;e<this.subviews.length;e++){var t=this.subviews[e];t instanceof u?t.setNeedsDisplay():console.log("ERROR: trying to call setNeedsDisplay: in object that it's not a view")}}},u.prototype.layerWithItemID=function(e){return MUICoreLayerSearchElementByID(this.layer,e)},u.prototype.setHidden=function(e){this._hidden=e,null!=this.layer&&(this.layer.style.display=e?"none":"")},Object.defineProperty(u.prototype,"hidden",{get:function(){return this._hidden},set:function(e){this.setHidden(e)},enumerable:!0,configurable:!0}),u.prototype.setBackgroundColor=function(e){this.layer.style.backgroundColor="#"+e},u.prototype.setBackgroundRGBColor=function(e,t,n,i){if(null==i){var o="rgb("+e+", "+t+", "+n+")";this.layer.style.backgroundColor=o}else{o="rgba("+e+", "+t+", "+n+", "+i+")";this.layer.style.backgroundColor=o}},u.prototype.getBackgroundColor=function(){return document.defaultView.getComputedStyle(this.layer,null).getPropertyValue("background-color")},u.prototype.setAlpha=function(e){if(this.willChangeValue("alpha"),this.alpha=e,this.didChangeValue("alpha"),null!=u.animationsChanges){var t={View:this,Key:"opacity",EndValue:e};u.animationsChanges.addObject(t)}else this.layer.style.opacity=e},u.prototype.setX=function(e){if(this.willChangeValue("frame"),this.x=e,this.didChangeValue("frame"),null!=u.animationsChanges){var t={View:this,Key:"left",EndValue:e+"px"};u.animationsChanges.addObject(t)}else this.layer.style.left=e+"px"},u.prototype.getX=function(){return this._getIntValueFromCSSProperty("left")},u.prototype.setY=function(e){if(this.willChangeValue("frame"),this.y=e,this.didChangeValue("frame"),null!=u.animationsChanges){var t={View:this,Key:"top",EndValue:e+"px"};u.animationsChanges.addObject(t)}else this.layer.style.top=e+"px"},u.prototype.getY=function(){return this._getIntValueFromCSSProperty("top")},u.prototype.setWidth=function(e){if(this.willChangeValue("frame"),this.width=e,this.didChangeValue("frame"),null!=u.animationsChanges){var t={View:this,Key:"width",EndValue:e+"px"};u.animationsChanges.addObject(t)}else this.layer.style.width=e+"px"},u.prototype.getWidth=function(){var e=this.layer.clientWidth,t=this._getIntValueFromCSSProperty("width"),n=Math.max(e,t);return isNaN(n)&&(n=0),n},u.prototype.setHeight=function(e){if(this.willChangeValue("height"),this.height=e,this.didChangeValue("height"),null!=u.animationsChanges){var t={View:this,Key:"height",EndValue:e+"px"};u.animationsChanges.addObject(t)}else this.layer.style.height=e+"px"},u.prototype.getHeight=function(){var e=this.height;return 0==e?e=this.layer.clientHeight:0==e?e=this.layer.height:0==e&&(e=this._getIntValueFromCSSProperty("height")),e},u.prototype.setFrameComponents=function(e,t,n,i){this.setX(e),this.setY(t),this.setWidth(n),this.setHeight(i)},u.prototype.setFrame=function(e){this.willChangeValue("frame"),this.setFrameComponents(e.origin.x,e.origin.y,e.size.width,e.size.height),this.didChangeValue("frame")},Object.defineProperty(u.prototype,"frame",{get:function(){return NSRect.rectWithValues(this.getX(),this.getY(),this.getWidth(),this.getHeight())},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"bounds",{get:function(){return NSRect.rectWithValues(0,0,this.getWidth(),this.getHeight())},enumerable:!0,configurable:!0}),u.prototype._getValueFromCSSProperty=function(e){return window.getComputedStyle(this.layer,null).getPropertyValue(e)},u.prototype._getIntValueFromCSSProperty=function(e){var t=this._getValueFromCSSProperty(e);1==t.hasSuffix("px")?t=t.substring(0,t.length-2):1==t.hasSuffix("%")&&(t=t.substring(0,t.length-1));return parseInt(t)},Object.defineProperty(u.prototype,"userInteraction",{set:function(e){e!=this._userInteraction&&(1==e?(this.layer.addEventListener("mousedown",this.mouseDownEvent.bind(this)),this.layer.addEventListener("mouseup",this.mouseUpEvent.bind(this))):(this.layer.removeEventListener("mousedown",this.mouseDownEvent),this.layer.removeEventListener("mouseup",this.mouseUpEvent)))},enumerable:!0,configurable:!0}),u.prototype.mouseDownEvent=function(e){var t=UIEvent.eventWithSysEvent(e);this.touchesBeganWithEvent(null,t),this.isMouseDown=!0,window.addEventListener("mousemove",this.mouseMoveEvent.bind(this)),e.preventDefault()},u.prototype.mouseUpEvent=function(e){this.isMouseDown=!1;var t=UIEvent.eventWithSysEvent(e);this.touchesEndedWithEvent(null,t)},u.prototype.mouseMoveEvent=function(e){if(0!=this.isMouseDown)if(0==e.buttons){window.removeEventListener("mousemove",this.mouseMoveEvent),this.isMouseDown=!1;var t=UIEvent.eventWithSysEvent(e);this.touchesEndedWithEvent(null,t)}else{t=UIEvent.eventWithSysEvent(e);this.touchesMovedWithEvent(null,t)}},u.prototype.touchesBeganWithEvent=function(e,t){for(var n=0;n<this.gestureRecognizers.length;n++){this.gestureRecognizers[n]._viewTouchesBeganWithEvent(e,t)}},u.prototype.touchesMovedWithEvent=function(e,t){for(var n=0;n<this.gestureRecognizers.length;n++){this.gestureRecognizers[n]._viewTouchesMovedWithEvent(e,t)}},u.prototype.touchesEndedWithEvent=function(e,t){for(var n=0;n<this.gestureRecognizers.length;n++){this.gestureRecognizers[n]._viewTouchesEndedWithEvent(e,t)}},u.prototype.addGestureRecognizer=function(e){this.gestureRecognizers.containsObject(e)||((e.view=this).gestureRecognizers.addObject(e),this.userInteraction=!0)},u.prototype.removeGestureRecognizer=function(e){e.view=null,this.gestureRecognizers.removeObject(e)},u.animateWithDuration=function(e,t,n,i){u.animationsChanges=[],u.animationsViews=[],u.animationTarget=t,u.animationCompletion=i,n.call(t);for(var o=0;o<u.animationsChanges.length;o++){var r=u.animationsChanges[o],l=r.View,s=r.Key,a=r.EndValue;switch(l.layer.style.transition=s+" "+e+"s",s){case"opacity":l.layer.style.opacity=a;break;case"x":l.layer.style.left=a;break;case"y":l.layer.style.top=a;break;case"width":l.layer.style.width=a;break;case"height":l.layer.style.height=a}u.addTrackingAnimationView(l)}u.animationsChanges=null},u.addTrackingAnimationView=function(e){-1<u.animationsViews.indexOf(e)||(u.animationsViews.addObject(e),e.layer.animationParams={View:e},e.layer.addEventListener("webkitTransitionEnd",u.animationDidFinish))},u.removeTrackingAnimationView=function(e){-1!=u.animationsViews.indexOf(e)&&(u.animationsViews.removeObject(e),e.layer.removeEventListener("webkitTransitionEnd",u.animationDidFinish),e.layer.style.transition="none",e.setNeedsDisplay())},u.animationDidFinish=function(e){var t=e.target.animationParams.View;u.removeTrackingAnimationView(t),0<u.animationsViews.length||(u.animationsChanges=null,(u.animationsViews=null)!=u.animationTarget&&null!=u.animationCompletion&&u.animationCompletion.call(u.animationTarget),u.animationTarget=null,u.animationCompletion=null)},u.animationsChanges=null,u.animationsViews=null,u.animationTarget=null,u.animationCompletion=null,u}(NSObject),UILabel=function(i){function e(){var e=null!==i&&i.apply(this,arguments)||this;return e._textLayer=null,e.autoAdjustFontSize="none",e.autoAdjustFontSizeValue=4,e}return __extends(e,i),e.prototype.init=function(){i.prototype.init.call(this),MUICoreLayerAddStyle(this.layer,"label"),this.setupLayers()},e.prototype.initWithLayer=function(e,t,n){i.prototype.initWithLayer.call(this,e,t,n),this._textLayer=MUICoreLayerGetFirstElementWithTag(this.layer,"SPAN"),this.setupLayers()},e.prototype.setupLayers=function(){null==this._textLayer&&(this.layer.innerHTML="",this._textLayer=document.createElement("span"),this._textLayer.style.top="3px",this._textLayer.style.left="3px",this._textLayer.style.right="3px",this._textLayer.style.bottom="3px",this.layer.appendChild(this._textLayer))},e.prototype.setText=function(e){this.text=e},Object.defineProperty(e.prototype,"text",{get:function(){return this._textLayer.innerHTML},set:function(e){this._textLayer.innerHTML=null!=e?e:""},enumerable:!0,configurable:!0}),e.prototype.setTextAlignment=function(e){this.layer.style.textAlign=e},e.prototype.setHightlighted=function(e){1==e?this._textLayer.classList.add("label_highlighted_color"):this._textLayer.classList.remove("label_highlighted_color")},e.prototype.setTextRGBColor=function(e,t,n){var i="rgb("+e+", "+t+", "+n+")";this._textLayer.style.color=i},e.prototype.setFontSize=function(e){this._textLayer.style.fontSize=e+"px"},e.prototype.setFontStyle=function(e){this._textLayer.style.fontWeight=e},e.prototype.setFontFamily=function(e){this._textLayer.style.fontFamily=e},e}(UIView),UIControl=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mouseOverTarget=null,e.mouseOverAction=null,e.mouseOutTarget=null,e.mouseOutAction=null,e._enabled=!0,e}return __extends(e,t),Object.defineProperty(e.prototype,"enabled",{get:function(){return this._enabled},set:function(e){this.setEnabled(e)},enumerable:!0,configurable:!0}),e.prototype.setEnabled=function(e){this._enabled=e,this.layer.style.opacity=1==e?"1.0":"0.10"},e.prototype.setOnMouseOverAction=function(e,t){this.mouseOverTarget=e,this.mouseOverAction=t;var n=this;this.layer.onmouseover=function(){n.enabled&&n.mouseOverAction.call(e)}},e.prototype.setOnMouseOutAction=function(e,t){this.mouseOutTarget=e,this.mouseOutAction=t;var n=this;this.layer.onmouseout=function(){n.enabled&&n.mouseOutAction.call(e)}},e}(UIView);!function(e){e[e.MomentaryPushIn=0]="MomentaryPushIn",e[e.PushOnPushOff=1]="PushOnPushOff",e[e.PushIn=2]="PushIn"}(UIButtonType||(UIButtonType={}));var UIModalPresentationStyle,UIModalTransitionStyle,UIButton=function(s){function e(){var e=null!==s&&s.apply(this,arguments)||this;return e._statusStyle=null,e._titleStatusStyle=null,e._titleLayer=null,e._imageStatusStyle=null,e._imageLayer=null,e.target=null,e.action=null,e._selected=!1,e.type=UIButtonType.MomentaryPushIn,e}return __extends(e,s),e.prototype.init=function(){s.prototype.init.call(this),MUICoreLayerAddStyle(this.layer,"btn"),this.setupLayers()},e.prototype.initWithLayer=function(e,i,t){s.prototype.initWithLayer.call(this,e,i,t);var n=this.layer.getAttribute("data-type");if("MomentaryPushIn"==n?this.type=UIButtonType.MomentaryPushIn:"PushOnPushOff"==n?this.type=UIButtonType.PushOnPushOff:"PushIn"==n&&(this.type=UIButtonType.PushIn),this._titleLayer=MUICoreLayerGetFirstElementWithTag(this.layer,"SPAN"),this._imageLayer=MUICoreLayerGetFirstElementWithTag(this.layer,"IMG"),null==this._imageLayer&&(this._imageLayer=MUICoreLayerGetFirstElementWithTag(this.layer,"DIV")),"selected"==this.layer.getAttribute("data-status")&&this.setSelected(!0),0<this.layer.childNodes.length)for(var o=function(e){var t=r.layer.childNodes[e];if("DIV"!=t.tagName&&"SECTION"!=t.tagName)return"continue";var n=t.getAttribute("data-action-selector");return null!=n?(r.setAction(r,function(){i[n](this)}),"break"):void 0},r=this,l=0;l<this.layer.childNodes.length;l++){if("break"===o(l))break}this.setupLayers()},e.prototype.setupLayers=function(){null==this._titleLayer&&(this._titleLayer=document.createElement("span"),this.layer.appendChild(this._titleLayer));var e=this.layer.getAttribute("data-title");null!=e&&this.setTitle(NSLocalizeString(e,e)),this.layer.addEventListener("click",function(e){e.stopPropagation()}),this.layer.addEventListener("mousedown",function(e){if(e.stopPropagation(),0!=this.enabled)switch(this.type){case UIButtonType.MomentaryPushIn:case UIButtonType.PushIn:this.setSelected(!0);break;case UIButtonType.PushOnPushOff:this.setSelected(!this.selected)}}.bind(this)),this.layer.addEventListener("mouseup",function(e){e.stopPropagation(),0!=this.enabled&&(this.type==UIButtonType.MomentaryPushIn&&this.setSelected(!1),null!=this.action&&null!=this.target&&this.action.call(this.target,this))}.bind(this))},e.prototype.initWithAction=function(e,t){this.init(),this.setAction(e,t)},e.prototype.setAction=function(e,t){this.target=e,this.action=t},e.prototype.setTitle=function(e){this._titleLayer.innerHTML=e},Object.defineProperty(e.prototype,"title",{get:function(){return this._titleLayer.innerHTML},set:function(e){this.setTitle(e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selected",{get:function(){return this._selected},set:function(e){this.setSelected(e)},enumerable:!0,configurable:!0}),e.prototype.setSelected=function(e){this._selected!=e&&(1==e?MUICoreLayerAddStyle(this.layer,"selected"):MUICoreLayerRemoveStyle(this.layer,"selected"),this._selected=e)},e.prototype.setImageURL=function(e){null!=e?this._imageLayer.setAttribute("src",e):this._imageLayer.removeAttribute("src")},e}(UIControl),UIViewController=function(o){function e(e){var t=o.call(this)||this;return t.layerID=null,t.view=null,t._htmlResourcePath=null,t._onViewLoadedTarget=null,t._onViewLoadedAction=null,t._onLoadLayerTarget=null,t._onLoadLayerAction=null,t._viewIsLoaded=!1,t._layerIsReady=!1,t._childViewControllers=[],t.parentViewController=null,t.presentingViewController=null,t.presentedViewController=null,t.navigationController=null,t.navigationItem=null,t.splitViewController=null,t.tabBarController=null,t.modalPresentationStyle=1==MIOCoreIsPhone()?UIModalPresentationStyle.FullScreen:UIModalPresentationStyle.PageSheet,t.modalTransitionStyle=UIModalTransitionStyle.CoverVertical,t.transitioningDelegate=null,t._contentSize=new NSSize(320,200),t._preferredContentSize=null,t._outlets={},t._presentationController=null,t._popoverPresentationController=null,t.layerID=e||MUICoreLayerIDFromObject(t),t}return __extends(e,o),e.prototype.init=function(){o.prototype.init.call(this),this.loadView()},e.prototype.initWithCoder=function(e){},e.prototype.initWithLayer=function(e,t,n){o.prototype.init.call(this);var i=MUICoreLayerGetFirstElementWithTag(e,"DIV");this.view=new UIView,this.view.initWithLayer(i,t,n),this.loadView()},e.prototype.initWithResource=function(e){if(null==e)throw new Error("UIViewController:initWithResource can't be null");o.prototype.init.call(this),this._htmlResourcePath=e,this.loadView()},e.prototype.localizeSubLayers=function(e){if(0!=e.length)for(var t=0;t<e.length;t++){var n=e[t];if("DIV"==n.tagName){var i=n.getAttribute("data-localize-key");null!=i&&(n.innerHTML=NSLocalizeString(i,i)),this.localizeSubLayers(n.childNodes)}}},e.prototype.localizeLayerIDWithKey=function(e,t){MUICoreLayerSearchElementByID(this.view.layer,e).innerHTML=NSLocalizeString(t,t)},e.prototype.loadView=function(){if(null==this.view){if(this.view=new UIView(this.layerID),null==this._htmlResourcePath)return this.view.init(),MUICoreLayerAddStyle(this.view.layer,"page"),void this._didLoadView();NSBundle.mainBundle().loadNibNamed(this._htmlResourcePath,this,null)}else this._didLoadView()},e.prototype._didLoadNibWithLayer=function(e){var t=(new DOMParser).parseFromString(e,"text/html").getElementById("kk");this.view.initWithLayer(t,this),this.view.awakeFromHTML(),this._didLoadView()},e.prototype._didLoadView=function(){this._layerIsReady=!0,1==MIOCoreIsPhone()&&MUICoreLayerAddStyle(this.view.layer,"phone"),null!=this._onLoadLayerTarget&&null!=this._onViewLoadedAction&&(this._onLoadLayerAction.call(this._onLoadLayerTarget),this._onLoadLayerTarget=null,this._onLoadLayerAction=null),null!=this._onViewLoadedAction&&null!=this._onViewLoadedTarget&&(this.viewDidLoad(),this._loadChildControllers())},e.prototype._loadChildControllers=function(){var e=this._childViewControllers.length;0<e?this._loadChildViewController(0,e):this._setViewLoaded(!0)},e.prototype._loadChildViewController=function(t,n){t<n?this._childViewControllers[t].onLoadView(this,function(){var e=t+1;this._loadChildViewController(e,n)}):this._setViewLoaded(!0)},e.prototype._setViewLoaded=function(e){this.willChangeValue("viewLoaded"),this._viewIsLoaded=e,this.didChangeValue("viewLoaded"),1==e&&null!=this._onViewLoadedAction&&this._onViewLoadedAction.call(this._onViewLoadedTarget),this._onViewLoadedTarget=null,this._onViewLoadedAction=null,this.view.setNeedsDisplay()},e.prototype.onLoadView=function(e,t){this._onViewLoadedTarget=e,this._onViewLoadedAction=t,1==this._viewIsLoaded?t.call(e):1==this._layerIsReady&&(this.viewDidLoad(),this._loadChildControllers())},e.prototype.onLoadLayer=function(e,t){1==this._layerIsReady?t.call(e):(this._onLoadLayerTarget=t,this._onLoadLayerAction=e)},Object.defineProperty(e.prototype,"viewIsLoaded",{get:function(){return this._viewIsLoaded},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"childViewControllers",{get:function(){return this._childViewControllers},enumerable:!0,configurable:!0}),e.prototype.addChildViewController=function(e){(e.parentViewController=this)._childViewControllers.push(e)},e.prototype.removeChildViewController=function(e){var t=this._childViewControllers.indexOf(e);-1!=t&&(this._childViewControllers.splice(t,1),e.parentViewController=null)},Object.defineProperty(e.prototype,"isPresented",{get:function(){if(null!=this._presentationController)return this._presentationController._isPresented},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"presentationController",{get:function(){return this._presentationController},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"popoverPresentationController",{get:function(){return null==this._popoverPresentationController&&(this._popoverPresentationController=new UIPopoverPresentationController,this._popoverPresentationController.init(),(this._popoverPresentationController.presentedViewController=this)._presentationController=this._popoverPresentationController),this._popoverPresentationController},enumerable:!0,configurable:!0}),e.prototype.showViewController=function(e,t){e.onLoadView(this,function(){this.view.addSubview(e.view),this.addChildViewController(e),_MUIShowViewController(this,e,this,t)})},e.prototype.presentViewController=function(t,n){var i=t.presentationController;if(null==i&&((i=new UIPresentationController).init(),i.presentedViewController=t,i.presentingViewController=this,t._presentationController=i),null==i.presentingViewController&&(i.presentingViewController=this),1==i._isPresented)throw new Error("You try to present a view controller that is already presented");t.onLoadView(this,function(){if(t.modalPresentationStyle==UIModalPresentationStyle.CurrentContext)this.view.addSubview(t.presentationController.presentedView),this.addChildViewController(t),_MUIShowViewController(this,t,null,n,this,function(){});else{var e=i.window;null==e&&((e=new UIWindow).init(),e.layer.style.background="",e.rootViewController=t,e.addSubview(i.presentedView),i.window=e),e.setHidden(!1),_MUIShowViewController(this,t,null,n,this,function(){e.makeKey()})}})},e.prototype.dismissViewController=function(e){for(var t=this._presentationController,n=this;null==t;)t=(n=n.parentViewController)._presentationController;var i=t.presentingViewController,o=t.presentedViewController;t.presentedView;_MUIHideViewController(o,i,null,this,function(){o.modalPresentationStyle==UIModalPresentationStyle.CurrentContext?(i.removeChildViewController(o),o.presentationController.presentedView.removeFromSuperview()):o.presentationController.window.setHidden(!0)})},e.prototype.transitionFromViewControllerToViewController=function(e,t,n,i,o,r){},e.prototype.viewDidLoad=function(){},e.prototype.viewWillAppear=function(e){for(var t=0;t<this._childViewControllers.length;t++){this._childViewControllers[t].viewWillAppear(e)}this.view.setViewIsVisible(!0)},e.prototype.viewDidAppear=function(e){for(var t=0;t<this._childViewControllers.length;t++){this._childViewControllers[t].viewDidAppear(e)}},e.prototype.viewWillDisappear=function(e){for(var t=0;t<this._childViewControllers.length;t++){this._childViewControllers[t].viewWillDisappear(e)}this.view.setViewIsVisible(!1)},e.prototype.viewDidDisappear=function(e){for(var t=0;t<this._childViewControllers.length;t++){this._childViewControllers[t].viewDidDisappear(e)}},e.prototype.contentHeight=function(){return this.view.getHeight()},e.prototype.setContentSize=function(e){this.willChangeValue("contentSize"),this._contentSize=e,this.didChangeValue("contentSize")},Object.defineProperty(e.prototype,"contentSize",{get:function(){return this._contentSize},set:function(e){this.setContentSize(e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"preferredContentSize",{get:function(){return this._preferredContentSize},set:function(e){this.setPreferredContentSize(e)},enumerable:!0,configurable:!0}),e.prototype.setPreferredContentSize=function(e){this.willChangeValue("preferredContentSize"),this._preferredContentSize=e,this.didChangeValue("preferredContentSize")},e}(NSObject);!function(e){e[e.FullScreen=0]="FullScreen",e[e.PageSheet=1]="PageSheet",e[e.FormSheet=2]="FormSheet",e[e.CurrentContext=3]="CurrentContext",e[e.Custom=4]="Custom",e[e.OverFullScreen=5]="OverFullScreen",e[e.OverCurrentContext=6]="OverCurrentContext",e[e.Popover=7]="Popover",e[e.None=8]="None"}(UIModalPresentationStyle||(UIModalPresentationStyle={})),function(e){e[e.CoverVertical=0]="CoverVertical",e[e.FlipHorizontal=1]="FlipHorizontal",e[e.CrossDisolve=2]="CrossDisolve"}(UIModalTransitionStyle||(UIModalTransitionStyle={}));var UIPopoverArrowDirection,UIPresentationController=function(n){function e(){var e=null!==n&&n.apply(this,arguments)||this;return e.presentationStyle=UIModalPresentationStyle.PageSheet,e.shouldPresentInFullscreen=!1,e._presentedViewController=null,e.presentingViewController=null,e.presentedView=null,e._transitioningDelegate=null,e._window=null,e._isPresented=!1,e}return __extends(e,n),e.prototype.initWithPresentedViewControllerAndPresentingViewController=function(e,t){n.prototype.init.call(this),this.presentedViewController=e,this.presentingViewController=t},e.prototype.setPresentedViewController=function(e){this._presentedViewController=e,this.presentedView=e.view},Object.defineProperty(e.prototype,"presentedViewController",{get:function(){return this._presentedViewController},set:function(e){this.setPresentedViewController(e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"transitioningDelegate",{get:function(){return null==this._transitioningDelegate&&(this._transitioningDelegate=new MUIModalTransitioningDelegate,this._transitioningDelegate.init()),this._transitioningDelegate},enumerable:!0,configurable:!0}),e.prototype.presentationTransitionWillBegin=function(){var e=this.presentedViewController,t=this.presentedView;this._calculateFrame(),e.modalPresentationStyle!=UIModalPresentationStyle.PageSheet&&e.modalPresentationStyle!=UIModalPresentationStyle.FormSheet&&e.modalPresentationStyle!=UIModalPresentationStyle.FullScreen&&1!=MIOCoreIsPhone()||MUICoreLayerAddStyle(t.layer,"modal_window")},e.prototype.presentationTransitionDidEnd=function(e){},e.prototype.dismissalTransitionWillBegin=function(){},e.prototype.dismissalTransitionDidEnd=function(e){},e.prototype._calculateFrame=function(){var e=this.presentingViewController,t=this.presentedViewController,n=this.presentedView;if(t.modalPresentationStyle==UIModalPresentationStyle.FullScreen)n.layer.style.left="0px",n.layer.style.top="0px",n.layer.style.width="100%",n.layer.style.height="100%";else if(t.modalPresentationStyle==UIModalPresentationStyle.CurrentContext){var i=e.view.getWidth(),o=e.view.getHeight();n.setFrame(NSRect.rectWithValues(0,0,i,o))}else if(t.modalPresentationStyle==UIModalPresentationStyle.PageSheet){var r=MUIWindowSize();null==(a=t.preferredContentSize)&&(a=new NSSize(320,200));i=a.width,o=a.height;var l=(r.width-i)/2;n.setFrame(NSRect.rectWithValues(0,0,i,o)),this.window.setFrame(NSRect.rectWithValues(l,0,i,o)),n.layer.classList.add("modal")}else if(t.modalPresentationStyle==UIModalPresentationStyle.FormSheet){r=MUIWindowSize();null==(a=t.preferredContentSize)&&(a=new NSSize(320,200));i=a.width,o=a.height,l=(r.width-i)/2;var s=(r.height-o)/2;n.setFrame(NSRect.rectWithValues(0,0,i,o)),this.window.setFrame(NSRect.rectWithValues(l,s,i,o)),n.layer.classList.add("modal")}else{var a;null==(a=t.preferredContentSize)&&(a=new NSSize(320,200));i=a.width,o=a.height;n.setFrame(NSRect.rectWithValues(0,0,i,o))}},Object.defineProperty(e.prototype,"window",{get:function(){return this._window},set:function(e){var t=this.presentedViewController;this._window=e,0==MIOCoreIsMobile()&&t.modalPresentationStyle!=UIModalPresentationStyle.CurrentContext&&t.addObserver(this,"preferredContentSize")},enumerable:!0,configurable:!0}),e.prototype.observeValueForKeyPath=function(e,t,n){"preferredContentSize"==e&&"did"==t&&(this.presentedView.layer.style.transition="left 0.25s, width 0.25s, height 0.25s",this._calculateFrame())},e}(NSObject),MUIModalTransitioningDelegate=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.modalTransitionStyle=null,e._presentAnimationController=null,e._dissmissAnimationController=null,e}return __extends(e,t),e.prototype.animationControllerForPresentedController=function(e,t,n){return null==this._presentAnimationController&&(this._presentAnimationController=new UIModalPresentAnimationController,this._presentAnimationController.init()),this._presentAnimationController},e.prototype.animationControllerForDismissedController=function(e){return null==this._dissmissAnimationController&&(this._dissmissAnimationController=new UIModalDismissAnimationController,this._dissmissAnimationController.init()),this._dissmissAnimationController},e}(NSObject),MUIAnimationController=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.transitionDuration=function(e){return 0},t.prototype.animateTransition=function(e){},t.prototype.animationEnded=function(e){},t.prototype.animations=function(e){return null},t}(NSObject),UIModalPresentAnimationController=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.transitionDuration=function(e){return.15},t.prototype.animateTransition=function(e){},t.prototype.animationEnded=function(e){},t.prototype.animations=function(e){var t=null,n=e.presentedViewController;return n.modalPresentationStyle!=UIModalPresentationStyle.PageSheet&&n.modalPresentationStyle!=UIModalPresentationStyle.FormSheet&&n.modalPresentationStyle!=UIModalPresentationStyle.FullScreen||(t=1==MIOCoreIsPhone()?MUIClassListForAnimationType(MUIAnimationType.SlideInUp):MUIClassListForAnimationType(MUIAnimationType.BeginSheet)),t},t}(NSObject),UIModalDismissAnimationController=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.transitionDuration=function(e){return.25},t.prototype.animateTransition=function(e){},t.prototype.animationEnded=function(e){},t.prototype.animations=function(e){var t=null,n=e.presentingViewController;return n.modalPresentationStyle!=UIModalPresentationStyle.PageSheet&&n.modalPresentationStyle!=UIModalPresentationStyle.FormSheet&&n.modalPresentationStyle!=UIModalPresentationStyle.FullScreen||(t=1==MIOCoreIsPhone()?MUIClassListForAnimationType(MUIAnimationType.SlideOutDown):MUIClassListForAnimationType(MUIAnimationType.EndSheet)),t},t}(NSObject);!function(e){e[e.Any=0]="Any",e[e.Up=1]="Up",e[e.Down=2]="Down",e[e.Left=3]="Left",e[e.Right=4]="Right"}(UIPopoverArrowDirection||(UIPopoverArrowDirection={}));var UIPopoverPresentationController=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.permittedArrowDirections=UIPopoverArrowDirection.Any,e.sourceView=null,e.sourceRect=NSRect.Zero(),e.delegate=null,e._contentSize=null,e._canvasLayer=null,e._contentView=null,e}return __extends(e,t),Object.defineProperty(e.prototype,"transitioningDelegate",{get:function(){return null==this._transitioningDelegate&&(this._transitioningDelegate=new MIOModalPopOverTransitioningDelegate,this._transitioningDelegate.init()),this._transitioningDelegate},enumerable:!0,configurable:!0}),e.prototype.presentationTransitionWillBegin=function(){this._calculateFrame(),MUICoreLayerAddStyle(this.presentedView.layer,"popover_window")},e.prototype.dismissalTransitionDidEnd=function(e){0!=e&&null!=this.delegate&&"function"==typeof this.delegate.popoverPresentationControllerDidDismissPopover&&this.delegate.popoverPresentationControllerDidDismissPopover(this)},e.prototype._calculateFrame=function(){var e=this.presentedViewController,t=this.presentedView,n=e.preferredContentSize.width,i=e.preferredContentSize.height,o=e.popoverPresentationController.sourceView,r=e.popoverPresentationController.sourceRect,l=!1,s=o.layer.getBoundingClientRect().top+r.size.height+10;s+i>window.innerHeight&&(s=o.layer.getBoundingClientRect().top-i-10),s<0&&(l=!0,s=(window.innerHeight-i)/2);var a=0;0==l?(a=o.layer.getBoundingClientRect().left+10)+n>window.innerWidth&&(a=o.layer.getBoundingClientRect().left+r.size.width-n+10):(a=o.layer.getBoundingClientRect().left+r.size.width+10)+n>window.innerWidth&&(a=o.layer.getBoundingClientRect().left-n-10),t.setFrame(NSRect.rectWithValues(0,0,n,i)),this.window.setFrame(NSRect.rectWithValues(a,s,n,i))},e.prototype._drawRoundRect=function(e,t,n,i,o){var r=this._canvasLayer.getContext("2d");r.beginPath(),r.moveTo(e+o,t),r.lineTo(e+n-o,t),r.quadraticCurveTo(e+n,t,e+n,t+o),r.lineTo(e+n,t+i-o),r.quadraticCurveTo(e+n,t+i,e+n-o,t+i),r.lineTo(e+o,t+i),r.quadraticCurveTo(e,t+i,e,t+i-o),r.lineTo(e,t+o),r.quadraticCurveTo(e,t,e+o,t),r.closePath();r.strokeStyle="rgba(208, 208, 219, 1)",r.lineWidth=1,r.stroke()},e}(UIPresentationController),MIOModalPopOverTransitioningDelegate=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.modalTransitionStyle=null,e._showAnimationController=null,e._dissmissAnimationController=null,e}return __extends(e,t),e.prototype.animationControllerForPresentedController=function(e,t,n){return null==this._showAnimationController&&(this._showAnimationController=new MIOPopOverPresentAnimationController,this._showAnimationController.init()),this._showAnimationController},e.prototype.animationControllerForDismissedController=function(e){return null==this._dissmissAnimationController&&(this._dissmissAnimationController=new MIOPopOverDismissAnimationController,this._dissmissAnimationController.init()),this._dissmissAnimationController},e}(NSObject),MIOPopOverPresentAnimationController=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.transitionDuration=function(e){return.25},t.prototype.animateTransition=function(e){},t.prototype.animationEnded=function(e){},t.prototype.animations=function(e){return MUIClassListForAnimationType(MUIAnimationType.FadeIn)},t}(NSObject),MIOPopOverDismissAnimationController=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.transitionDuration=function(e){return.25},t.prototype.animateTransition=function(e){},t.prototype.animationEnded=function(e){},t.prototype.animations=function(e){return MUIClassListForAnimationType(MUIAnimationType.FadeOut)},t}(NSObject),UINavigationItem=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.backBarButtonItem=null,e.titleView=null,e.title=null,e.leftView=null,e.rightView=null,e}return __extends(e,t),e.prototype.initWithLayer=function(e){if(0<e.childNodes.length){for(var t=0;t<e.childNodes.length;t++){var n=e.childNodes[t];if("DIV"==n.tagName)if(null!=n.getAttribute("data-nav-item-left"))(i=new UIView).initWithLayer(n,this),this.leftView=i;else if(null!=n.getAttribute("data-nav-item-center")){(i=new UIView).initWithLayer(n,this),this.titleView=i}else if(null!=n.getAttribute("data-nav-item-right")){var i;(i=new UIView).initWithLayer(n,this),this.rightView=i}}var o=MUICoreLayerSearchElementByAttribute(e,"data-nav-item-back");null!=o&&(this.backBarButtonItem=new UIButton,this.backBarButtonItem.initWithLayer(o,this))}},e}(NSObject);function UINavItemSearchInLayer(e){if(0<e.childNodes.length)for(var t=0;t<e.childNodes.length;t++){var n=e.childNodes[t];if("DIV"==n.tagName&&null!=n.getAttribute("data-nav-item")){var i=new UINavigationItem;if(i.initWithLayer(n),null==i.titleView){var o=n.getAttribute("data-nav-item-title");null!=o&&(i.title=o)}return i}}return null}var UISplitViewControllerDisplayMode,UINavigationController=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.rootViewController=null,e.viewControllersStack=[],e.currentViewControllerIndex=-1,e._pushAnimationController=null,e._popAnimationController=null,e}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this),this.view.layer.style.overflow="hidden"},e.prototype.initWithRootViewController=function(e){this.init(),this.setRootViewController(e)},e.prototype.setRootViewController=function(e){this.rootViewController=e,this.view.addSubview(e.view),this.viewControllersStack.push(e),this.currentViewControllerIndex=0,(this.rootViewController.navigationController=this).addChildViewController(e)},e.prototype.viewWillAppear=function(e){this.currentViewControllerIndex<0||this.viewControllersStack[this.currentViewControllerIndex].viewWillAppear(e)},e.prototype.viewDidAppear=function(e){this.currentViewControllerIndex<0||this.viewControllersStack[this.currentViewControllerIndex].viewDidAppear(e)},e.prototype.viewWillDisappear=function(e){this.currentViewControllerIndex<0||this.viewControllersStack[this.currentViewControllerIndex].viewWillDisappear(e)},e.prototype.viewDidDisappear=function(e){this.currentViewControllerIndex<0||this.viewControllersStack[this.currentViewControllerIndex].viewDidDisappear(e)},e.prototype.pushViewController=function(e,t){var n=this.viewControllersStack[this.currentViewControllerIndex];this.viewControllersStack.push(e),this.currentViewControllerIndex++,e.navigationController=this,e.onLoadView(this,function(){null!=e.navigationItem&&null!=e.navigationItem.backBarButtonItem&&e.navigationItem.backBarButtonItem.setAction(this,function(){e.navigationController.popViewController()}),this.view.addSubview(e.view),this.addChildViewController(e),null!=e.preferredContentSize&&(this.preferredContentSize=e.preferredContentSize),_MUIShowViewController(n,e,this,t)})},e.prototype.popViewController=function(e){if(0!=this.currentViewControllerIndex){var t=this.viewControllersStack[this.currentViewControllerIndex];this.currentViewControllerIndex--,this.viewControllersStack.pop();var n=this.viewControllersStack[this.currentViewControllerIndex];null!=n.preferredContentSize&&(this.contentSize=n.preferredContentSize),_MUIHideViewController(t,n,this,this,function(){t.removeChildViewController(this),t.view.removeFromSuperview()})}},e.prototype.popToRootViewController=function(e){if(1!=this.viewControllersStack.length){for(var t=this.viewControllersStack.pop(),n=this.currentViewControllerIndex-1;0<n;n--){var i=this.viewControllersStack.pop();i.view.removeFromSuperview(),this.removeChildViewController(i)}this.currentViewControllerIndex=0;var o=this.viewControllersStack[0];this.contentSize=o.preferredContentSize,_MUIHideViewController(t,o,this,this,function(){t.view.removeFromSuperview(),this.removeChildViewController(t)})}},Object.defineProperty(e.prototype,"preferredContentSize",{get:function(){return this.currentViewControllerIndex<0?this._preferredContentSize:this.viewControllersStack[this.currentViewControllerIndex].preferredContentSize},set:function(e){this.setPreferredContentSize(e)},enumerable:!0,configurable:!0}),e.prototype.animationControllerForPresentedController=function(e,t,n){return null==this._pushAnimationController&&(this._pushAnimationController=new MUIPushAnimationController,this._pushAnimationController.init()),this._pushAnimationController},e.prototype.animationControllerForDismissedController=function(e){return null==this._popAnimationController&&(this._popAnimationController=new MUIPopAnimationController,this._popAnimationController.init()),this._popAnimationController},e}(UIViewController),MUIPushAnimationController=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.transitionDuration=function(e){return.25},t.prototype.animateTransition=function(e){},t.prototype.animationEnded=function(e){},t.prototype.animations=function(e){return MUIClassListForAnimationType(MUIAnimationType.Push)},t}(NSObject),MUIPopAnimationController=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.transitionDuration=function(e){return.25},t.prototype.animateTransition=function(e){},t.prototype.animationEnded=function(e){},t.prototype.animations=function(e){return MUIClassListForAnimationType(MUIAnimationType.Pop)},t}(NSObject);!function(e){e[e.Automatic=0]="Automatic",e[e.PrimaryHidden=1]="PrimaryHidden",e[e.AllVisible=2]="AllVisible",e[e.PrimaryOverlay=3]="PrimaryOverlay"}(UISplitViewControllerDisplayMode||(UISplitViewControllerDisplayMode={}));var UISplitViewController=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.masterView=null,e.detailView=null,e.preferredDisplayMode=UISplitViewControllerDisplayMode.Automatic,e._displayModeButtonItem=null,e._collapsed=!1,e._masterViewController=null,e._detailViewController=null,e._pushAnimationController=null,e._popAnimationController=null,e}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this),this.masterView=new UIView,this.masterView.init(),0==MIOCoreIsPhone()&&MUICoreLayerAddStyle(this.masterView.layer,"master-view"),this.view.addSubview(this.masterView),0==MIOCoreIsPhone()&&(this.detailView=new UIView,this.detailView.init(),MUICoreLayerAddStyle(this.detailView.layer,"detail-view"),this.view.addSubview(this.detailView))},Object.defineProperty(e.prototype,"displayMode",{get:function(){return UISplitViewControllerDisplayMode.Automatic},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"displayModeButtonItem",{get:function(){return null!=this._displayModeButtonItem||(this._displayModeButtonItem=new UIButton,this._displayModeButtonItem.initWithAction(this,this.displayModeButtonItemAction)),this._displayModeButtonItem},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"collapsed",{get:function(){return this._collapsed},enumerable:!0,configurable:!0}),e.prototype.setCollapsed=function(e){this.willChangeValue("collapsed"),this._collapsed=e,this.didChangeValue("collapsed")},e.prototype.setMasterViewController=function(e){null!=this._masterViewController&&(this._masterViewController.view.removeFromSuperview(),this.removeChildViewController(this._masterViewController),this._masterViewController=null),null!=e&&(e.parent=this,(e.splitViewController=this).masterView.addSubview(e.view),this.addChildViewController(e),this._masterViewController=e)},e.prototype.setDetailViewController=function(e){1!=MIOCoreIsPhone()&&(null!=this._detailViewController&&(this._detailViewController.view.removeFromSuperview(),this.removeChildViewController(this._detailViewController),this._detailViewController=null),null!=e&&(e.parent=this,(e.splitViewController=this).detailView.addSubview(e.view),this.addChildViewController(e),this._detailViewController=e))},e.prototype.showDetailViewController=function(e){e.splitViewController=this,1==MIOCoreIsPhone()?this._pushDetailViewController(e):this._showDetailViewController(e)},Object.defineProperty(e.prototype,"masterViewController",{get:function(){return this._masterViewController},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"detailViewController",{get:function(){return this._detailViewController},enumerable:!0,configurable:!0}),e.prototype._showDetailViewController=function(e){var t=this._detailViewController,n=e;t!=n&&n.onLoadView(this,function(){this.detailView.addSubview(n.view),this.addChildViewController(n),this._detailViewController=e,_MUIShowViewController(t,n,this,!1,this,function(){t.view.removeFromSuperview(),this.removeChildViewController(t)})})},e.prototype._pushDetailViewController=function(e){var t=this._masterViewController;e.onLoadView(this,function(){this.view.addSubview(e.view),this.addChildViewController(e),null!=(this._detailViewController=e).preferredContentSize&&(this.preferredContentSize=e.preferredContentSize),_MUIShowViewController(t,e,this,!0,this,function(){this.setCollapsed(!0)})})},e.prototype._popViewController=function(){var e=this.detailViewController,t=this.masterViewController;null!=t.preferredContentSize&&(this.contentSize=t.preferredContentSize),_MUIHideViewController(e,t,this,this,function(){e.removeChildViewController(this),e.view.removeFromSuperview()})},e.prototype.displayModeButtonItemAction=function(){1==MIOCoreIsPhone()&&this._popViewController()},e.prototype.animationControllerForPresentedController=function(e,t,n){if(0!=MIOCoreIsPhone())return null==this._pushAnimationController&&(this._pushAnimationController=new MUIPushAnimationController,this._pushAnimationController.init()),this._pushAnimationController},e.prototype.animationControllerForDismissedController=function(e){if(0!=MIOCoreIsPhone())return null==this._popAnimationController&&(this._popAnimationController=new MUIPopAnimationController,this._popAnimationController.init()),this._popAnimationController},e}(UIViewController);function MUIOutletRegister(e,t,n){e._outlets[t]=n}function MUIOutletQuery(e,t){return e._outlets[t]}function MUIOutlet(e,t,n,i){var o=MUIOutletQuery(e,t);if(null!=o)return o;var r=null;if(e instanceof UIView?r=MUICoreLayerSearchElementByID(e.layer,t):e instanceof UIViewController&&(r=MUICoreLayerSearchElementByID(e.view.layer,t)),null==r)return null;null==n&&(n=r.getAttribute("data-class")),null==n&&(n="UIView");var l=NSClassFromString(n);if(l.initWithLayer(r,e,i),MUIOutletRegister(e,t,l),e instanceof UIView)e._linkViewToSubview(l);else if(e instanceof UIViewController)if(l instanceof UIView)e.view._linkViewToSubview(l);else{if(!(l instanceof UIViewController))throw new Error("UIOutlet: Wrong type");e.addChildViewController(l)}return l instanceof UIView&&l.awakeFromHTML(),l}function MUIWindowSize(){var e=document.body.clientWidth,t=window.innerHeight;return new NSSize(e,t)}function _MUIShowViewController(e,t,n,i,o,r){t.viewWillAppear(),t.modalPresentationStyle!=UIModalPresentationStyle.FullScreen&&t.modalPresentationStyle!=UIModalPresentationStyle.CurrentContext||e.viewWillDisappear();var l=null,s=t.presentationController;if(l=null!=s?s.presentedView:t.view,0!=i){var a={};a.presentingViewController=e,a.presentedViewController=t,a.presentedView=l,null!=s&&s.presentationTransitionWillBegin();var u=null;null!=t.transitioningDelegate?u=t.transitioningDelegate.animationControllerForPresentedController(t,e,n):null!=n&&"function"==typeof n.animationControllerForPresentedController?u=n.animationControllerForPresentedController(t,e,n):null!=s&&(u=s.transitioningDelegate.animationControllerForPresentedController(t,e,n)),_MUIAnimationStart(l.layer,u,a,this,function(){_MUIAnimationDidStart(e,t,s,o,r)})}else _MUIAnimationDidStart(e,t,s,o,r)}function _MUIAnimationDidStart(e,t,n,i,o){t.viewDidAppear(),t.modalPresentationStyle!=UIModalPresentationStyle.FullScreen&&t.modalPresentationStyle!=UIModalPresentationStyle.CurrentContext||e.viewDidDisappear(),null!=n&&(n.presentationTransitionDidEnd(!0),n._isPresented=!0),null!=i&&null!=o&&o.call(i)}function _MUIHideViewController(e,t,n,i,o){e.modalPresentationStyle!=UIModalPresentationStyle.FullScreen&&e.modalPresentationStyle!=UIModalPresentationStyle.CurrentContext&&1!=MIOCoreIsPhone()||t.viewWillAppear(),e.viewWillDisappear();var r=null,l=e.presentationController;r=null!=l?l.presentedView:e.view;var s=null;null!=e.transitioningDelegate?s=e.transitioningDelegate.animationControllerForDismissedController(e):null!=n&&"function"==typeof n.animationControllerForDismissedController?s=n.animationControllerForDismissedController(e):null!=l&&(s=l.transitioningDelegate.animationControllerForDismissedController(e));var a={};a.presentingViewController=e,a.presentedViewController=t;var u=(a.presentedView=r).layer;null!=l&&l.dismissalTransitionWillBegin(),_MUIAnimationStart(u,s,a,this,function(){e.modalPresentationStyle!=UIModalPresentationStyle.FullScreen&&e.modalPresentationStyle!=UIModalPresentationStyle.CurrentContext||t.viewDidAppear(),e.viewDidDisappear(),null!=l&&(l.dismissalTransitionDidEnd(!0),l._isPresented=!1),null!=i&&null!=o&&o.call(i)})}function _MUITransitionFromViewControllerToViewController(e,t,n,i,o){t.viewWillAppear(),e.viewWillDisappear();var r=null;null!=t.transitioningDelegate?r=t.transitioningDelegate.animationControllerForPresentedController(t,e,n):null!=n&&null!=n.transitioningDelegate&&(r=n.transitioningDelegate.animationControllerForPresentedController(t,e,n));var l={};l.presentingViewController=e,l.presentedViewController=t,_MUIAnimationStart((l.presentedView=t).view.layer,r,l,this,function(){t.viewDidAppear(),e.viewDidDisappear(),null!=i&&null!=o&&o.call(i)})}var UIWindow=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.rootViewController=null,e._resizeWindow=!1,e}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this),MUICoreLayerAddStyle(this.layer,"view")},e.prototype.initWithRootViewController=function(e){this.init(),this.rootViewController=e,this.addSubview(e.view)},e.prototype.makeKey=function(){UIApplication.sharedInstance().makeKeyWindow(this)},e.prototype.makeKeyAndVisible=function(){this.makeKey(),this.setHidden(!1)},e.prototype.layoutSubviews=function(){null!=this.rootViewController?this.rootViewController.view.layoutSubviews():t.prototype.layoutSubviews.call(this)},e.prototype.addSubview=function(e){e._window=this,t.prototype.addSubview.call(this,e)},e.prototype._addLayerToDOM=function(){1!=this._isLayerInDOM&&null!=this.layer&&(document.body.appendChild(this.layer),this._isLayerInDOM=!0)},e.prototype.removeFromSuperview=function(){this._removeLayerFromDOM()},e.prototype._removeLayerFromDOM=function(){0!=this._isLayerInDOM&&(document.body.removeChild(this.layer),this._isLayerInDOM=!1)},e.prototype.setHidden=function(e){0==e?this._addLayerToDOM():this._removeLayerFromDOM()},e.prototype._eventHappendOutsideWindow=function(){this._dismissRootViewController()},e.prototype._becameKeyWindow=function(){},e.prototype._resignKeyWindow=function(){this._dismissRootViewController()},e.prototype._dismissRootViewController=function(){1==this.rootViewController.isPresented&&(this.rootViewController.presentationController instanceof UIPopoverPresentationController&&this.rootViewController.dismissViewController(!0))},e}(UIView),UIResponder=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(NSObject),UIApplication=function(){function e(){if(this.delegate=null,this.isMobile=!1,this.defaultLanguage=null,this.currentLanguage=null,this.languages=null,this.ready=!1,this.downloadCoreFileCount=0,this._sheetViewController=null,this._sheetSize=null,this._popUpMenu=null,this._popUpMenuControl=null,this._popOverWindow=null,this._popOverWindowFirstClick=!1,this._popOverViewController=null,this._windows=[],this._keyWindow=null,this._mainWindow=null,this.mainResourceURLString=null,this.windowZIndexOffset=0,null!=e._sharedInstance)throw new Error("UIWebApplication: Instantiation failed: Use sharedInstance() instead of new.")}return e.sharedInstance=function(){return null==e._sharedInstance&&(e._sharedInstance=new e),e._sharedInstance},e.prototype.setLanguage=function(e,n,i){var t=MIOCoreGetLanguages();null==t&&i.call(n);var o=t[e];null==o&&i.call(n);var r=NSURLRequest.requestWithURL(NSURL.urlWithString(o));(new NSURLConnection).initWithRequestBlock(r,this,function(e,t){200==e&&MIOCoreStringSetLocalizedStrings(JSON.parse(t.replace(/(\r\n|\n|\r)/gm,""))),i.call(n)})},e.prototype.downloadAppPlist=function(n,i){var e=NSURLRequest.requestWithURL(NSURL.urlWithString("app.plist"));(new NSURLConnection).initWithRequestBlock(e,this,function(e,t){200==e&&MIOCoreBundleSetAppResource("app","plist",t),i.call(n,t)})},e.prototype.run=function(){this.downloadAppPlist(this,function(e){if(null==e)throw new Error("We couldn't download the app.plist");var t=NSPropertyListSerialization.propertyListWithData(e,0,0,null);this.mainResourceURLString=t.UIMainStoryboardFile;var n=t.Languages;if(null==n)this._run();else{for(var i in n){var o=n[i];MIOCoreAddLanguage(i,o)}var r=MIOCoreGetPlatformLanguage();this.setLanguage(r,this,function(){this._run()})}})},e.prototype._run=function(){this.delegate.applicationDidFinishLaunchingWithOptions(),this._mainWindow=this.delegate.window,null==this._mainWindow?MUICoreBundleLoadNibName(this.mainResourceURLString,this,function(e){this.delegate.window=new UIWindow,this.delegate.window.initWithRootViewController(e),this._launchApp()}):this._launchApp()},e.prototype._launchApp=function(){this.delegate.window.makeKeyAndVisible(),this.delegate.window.rootViewController.onLoadView(this,function(){this.delegate.window.rootViewController.viewWillAppear(!1),this.delegate.window.rootViewController.viewDidAppear(!1),this.ready=!0})},e.prototype.setLanguageURL=function(e,t){null==this.languages&&(this.languages={}),this.languages[e]=t},e.prototype.setDefaultLanguage=function(e){this.defaultLanguage=e},e.prototype.downloadLanguage=function(e,i){var t=this.languages[e];(new NSURLConnection).initWithRequestBlock(NSURLRequest.requestWithURL(t),this,function(e,t){if(null!=t){var n=JSON.parse(t.replace(/(\r\n|\n|\r)/gm,""));MIOCoreStringSetLocalizedStrings(n)}i.call(this)})},e.prototype.showModalViewContoller=function(e){(new UIWindow).initWithRootViewController(e),document.body.appendChild(e.view.layer)},e.prototype.showMenuFromControl=function(e,t){null!=this._popUpMenu&&t.layerID!=this._popUpMenu.layerID&&this._popUpMenu.hide(),this._popUpMenuControl=e,this._popUpMenu=t,this.delegate.window.addSubview(this._popUpMenu);var n=e.layer.getBoundingClientRect().left,i=e.layer.getBoundingClientRect().top+e.layer.getBoundingClientRect().height;this._popUpMenu.setX(n),this._popUpMenu.setY(i),this._popUpMenu.layer.style.zIndex=200,this._popUpMenu.layout()},e.prototype.hideMenu=function(){null!=this._popUpMenu&&(this._popUpMenu.removeFromSuperview(),this._popUpMenu=null)},e.prototype._resizeEvent=function(e){this.delegate.window.layoutSubviews()},e.prototype._clickEvent=function(e){e.coreEvent.target;var t,n=e.x,i=e.y;null!=this._popUpMenu&&(n>(t=this._popUpMenuControl.layer.getBoundingClientRect()).left&&n<t.right&&i>t.top&&i<t.bottom||this._popUpMenu.hide());null!=this._keyWindow&&(n>(t=this._keyWindow.layer.getBoundingClientRect()).left&&n<t.right&&i>t.top&&i<t.bottom||this._keyWindow._eventHappendOutsideWindow())},e.prototype.setPopOverViewController=function(e){null!=this._popOverViewController&&this._popOverViewController.dismissViewController(!0),this._popOverViewController=e},e.prototype.showPopOverControllerFromRect=function(e,t){null!=this._popOverWindow&&this.hidePopOverController(),null==this._popOverWindow&&(this._popOverWindow=new UIWindow("popover_window"),this._popOverWindow.initWithRootViewController(e.popoverPresentationController()),this._popOverWindow.setFrame(e.popoverPresentationController().frame)),this._popOverWindow.rootViewController.onLoadView(this,function(){this._popOverWindow.rootViewController.viewWillAppear(!0),this._popOverWindow.rootViewController.viewDidAppear(!0)}),this._popOverWindowFirstClick=!0},e.prototype.hidePopOverController=function(){this._popOverWindow.rootViewController.viewWillDisappear(!0),this._popOverWindow.removeFromSuperview(),this._popOverWindow.rootViewController.viewDidDisappear(!0),this._popOverWindow=null},e.prototype.makeKeyWindow=function(e){this._keyWindow!==e&&(null!=this._keyWindow&&this._keyWindow._resignKeyWindow(),this._keyWindow=e)},e}();